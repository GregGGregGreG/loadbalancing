\documentclass[11pt, a4paper]{article}
% \usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage[margin=1.0in]{geometry}
\usepackage{color}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage{url} 
\usepackage{float}
\usepackage{enumitem}
\usepackage{subcaption}

\lstnewenvironment{python}[1][]
{\lstset{
		language=python,
		numbers=left,
		numberstyle=\tiny,
		keywordstyle=\color{blue},       	% keyword style
		basicstyle=\footnotesize\ttfamily,	% font
		numbers=left,						% line numbers
		tabsize=2,							% tabsize in spaces
		#1}}
{}

\lstnewenvironment{bash}[1][]
{\lstset{
		language=bash,
		numbers=left,
		numberstyle=\tiny,
		numbers=none,
		basicstyle=\footnotesize\ttfamily,	% font
		tabsize=2,							% tabsize in spaces
		#1}}
{}

\lstnewenvironment{code}[1][]
{\lstset{numbers=left,
		numberstyle=\tiny,
		keywordstyle=\color{blue},       % keyword style
		basicstyle=\footnotesize\ttfamily,	% font
		numbers=left,						% line numbers
		tabsize=2,							% tabsize in spaces
		#1}}
{}

\title{DezSys03 - Synchronization of heterogeneous databases}
\author{Elias Frantar, Gary Ye (5AHITT)}
\date{\today{}, Wien}
\begin{document}

\lstset{
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\footnotesize,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
% commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
% frame=single,                    % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
% language=bash,                   % the language of the code
  morekeywords={*,...},            % if you want to add more keywords to the set
  numbers=none,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
%  numberstyle=\tiny\color{gray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
%  stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{red},     % string literal style
  tabsize=2,                       % sets default tabsize to 2 spaces
  title=\lstname,                   % show the filename of files included with \lstinputlisting; also try caption instead of title
  belowskip=-3em,    
}

\setlength\parindent{0pt}

\maketitle
\newpage
\tableofcontents
\newpage

\section{Requirements}

\subsection{Aufgabenstellung}

Es soll ein Load Balancer mit mindestens 2 unterschiedlichen
Load-Balancing Methoden (jeweils 7 Punkte) implementiert werden
(Ã¤hnlich dem PI Beispiel [1]; Loesung zum Teil veraltet [2]). Eine
Kombination von mehreren Methoden ist moeglich. Die Berechnung
bzw. das Service ist frei waehlbar!
\\\\
Folgende Load Balancing Methoden stehen zur Auswahl:

\begin{itemize}
	\item Weighted Round-Robin
	\item Least Connection
	\item Least Connected Slow- Start Time
	\item Weighted Least Connection
	\item Agent Based Adaptive Balancing / Server Probes
\end{itemize}

Um die Komplexitaet zu steigern, soll zusaetzlich eine "Session
Persistence" (2 Punkte) implementiert werden.

\subsection{Tests}

Die Tests sollen so aufgebaut sein, dass in der Gruppe jedes Mitglied
mehrere Server fahren und ein Gruppenmitglied mehrere Anfragen an den
Load Balancer stellen. Fuer die Abnahme wird empfohlen, dass jeder
Server eine Ausgabe mit entsprechenden Informationen ausgibt, damit
die Verteilung der Anfragen demonstriert werden kann.

\subsection{Modalitaeten}

Gruppenarbeit: 2 Personen Abgabe: Protokoll mit Designueberlegungen /
Umsetzung / Testszenarien, Sourcecode (mit allen notwendigen
Bibliotheken), Java-Doc, Jar

\subsection{Quellen}

[1] "Praktische Arbeit 2 zur Vorlesung 'Verteilte Systeme' ETH
Zuerich, SS 2002", Prof.Dr.B.Plattner, Uebernommen von
Prof.Dr.F.Mattern

(http://www.tik.ee.ethz.ch/tik/education/lectures/VS/SS02/Praktikum/aufgabe2.pdf)

[2] http://www.tik.ee.ethz.ch/education/lectures/VS/SS02/Praktikum/loesung2.zip

\newpage

\section{Effort Estimation and Work Distribution}

The following table compares the estimated with the actually needed
amount of time for completing each individual task.

The estimation is in the second column while the columns that follow
are actual values.

\parskip 12pt
\begin{tabular} {| l | c | c | c | c |}
	\hline
	Task					&	Estimation		& 	Elias 	& 	Gary 	& 	Team	\\ \hline \hline
	Preparation				&	2				&			&  			&			\\ \hline
	Design					&	4				&			&			&			\\ \hline
	Implementation			&	6				&			&			& 	 		\\ \hline
	Testing					&	4				&			& 	 		& 	 		\\ \hline
	Documentation			&	10				&			&	 		& 			\\ \hline 
	Total					&	26				&			&			& 			\\
	\hline
\end{tabular}

\section{Design}

\subsection{Assumptions}

Because of the limited time for the present exercise, it is not
possible to handle all problems. Therefore the following assumptions
have been made under which our solution will work:

\vspace{-10pt}
\begin{itemize}
\item Connections do not end while the load-balancer is running
\item Servers are registered at the load-balancer before and only
  before startup
\item Sessions cannot end
\item All connections have the same size/weight/package-length/...
\end{itemize}
\vspace{-10pt}

Deduced from these assumptions our implementation will have the
following functional restrictions:

\vspace{-10pt}
\begin{itemize}
\item Additional servers \textit{cannot} be dynamically added during
  runtime
\item Load-balancer will \textit{not} be acknowledged when a
  connection is closed
\item A client who connected to a server once will (session
  persistence) \textit{always} be reconnected to same server (as long
  as the load-balancer is up)
\item Load will only be balanced depending on \textit{the number of
    connections}, thus ignoring their length/weight/traffic/...
\end{itemize}
\vspace{-10pt}

\subsection{Technologies}

\subsubsection{Remote Procedure Call}

XML RPC is a technology that has already been thoroughly addressed in
the fourth grade of the IT department. Due to the preexisting
experience and the simpleness of this technology, we decided to use
the Xmlrpc library provided by Apache.

Its weakness in the performance, compared to other technologies, e.g.,
RMI, has not been a concern for us since this exercise is designed to
teach the different load balancing strategies. 

% Add link to Apache XMLRPC

\subsection{Load Balancing Scheduling Strategies}

From the given list of the scheduling strategies we picked Weighted
Round Robin and Least Connection First as the strategies to be
analyzed.

In the following sections we will, for simplicity's sake, abbreviate
Weighted Round Robin and Least Connection First as WRR and LCF
respectively.

Since the scheduling strategies that can be found in the Internet are
very abstract, we will also describe how we concretely applied them in
the use case of our application. 

\subsubsection{Weighted Round Robin}

% TODO: Described WRR

\subsubsection{Least Connection First}

The LCF strategy can be explained very simply. For each server
instance $i$ we assign a number $c_i$, which denotes the number of
active/open connections on server $i$. Whenever the load balancer
receives a new request, it searches for the server with the minimum
$c_i$ and picks it as the server that should process the new
request. It subsequently increments $c_i$ by $1$. 

Denote $n$ as the number of servers that the load balancer
maintains. A simple algorithm iterates through all the given servers
and picks the server with the minimum $c_i$, which results in a linear
$O(n)$ algorithm. This might work well in practice, since $n$ cannot
range to more than 3 figures in reality (except large companies like
Google, NSA), but it is still theoretically slow. 

We can improve the searching step to $O(\log n)$ by using a subtle
data structure like a Balanced Binary Search Tree. Probably the
easiest BBST data structure to implement is a treap, which relies its
logarithmic height on the randomness of the priority keys.

\subsection{Software Design}

\section{Testing}

\subsection{Unit Testing}

\subsection{Manual Testing}

\section{Ocurred Problems}



\nocite{*}
\bibliographystyle{plain}
\bibliography{bibliography}

\end{document}
